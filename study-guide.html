<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IRTM Study Guide</title>
    <style>
        :root {
            --bg-color: #faf9f7;
            --text-color: #1a1a1a;
            --accent-color: #2563eb;
            --border-color: #d1d5db;
            --solution-bg: #f0f9ff;
            --priority-high: #dc2626;
            --priority-med: #ea580c;
            --priority-low: #6b7280;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Georgia", "Times New Roman", serif;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.7;
            font-size: 18px;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: white;
            border-bottom: 1px solid var(--border-color);
            padding: 0.5rem 1rem;
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            z-index: 100;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        nav button {
            padding: 0.4rem 0.8rem;
            border: 1px solid var(--border-color);
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            white-space: nowrap;
            font-family: inherit;
        }

        nav button:hover {
            background: var(--bg-color);
        }

        nav button.active {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        nav .nav-home {
            padding: 0.4rem 0.6rem;
            border: 1px solid var(--border-color);
            background: white;
            border-radius: 4px;
            font-size: 0.85rem;
            white-space: nowrap;
            font-family: inherit;
            text-decoration: none;
            color: #6b7280;
            margin-left: auto;
            display: flex;
            align-items: center;
        }

        nav .nav-home:hover {
            background: var(--bg-color);
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        /* Progress indicator */
        .progress {
            position: fixed;
            top: 50px;
            left: 0;
            right: 0;
            height: 3px;
            background: #e5e7eb;
            z-index: 99;
        }

        .progress-bar {
            height: 100%;
            background: var(--accent-color);
            transition: width 0.3s ease;
        }

        /* Question container */
        .question-container {
            display: none;
            min-height: 100vh;
            padding: 80px 2rem 4rem;
            max-width: 900px;
            margin: 0 auto;
        }

        .question-container.active {
            display: block;
        }

        /* Question card */
        .question-card {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .question-header {
            display: flex;
            align-items: baseline;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--bg-color);
        }

        .question-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-color);
        }

        .question-meta {
            font-size: 0.9rem;
            color: #666;
        }

        .priority {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 3px;
            font-size: 0.75rem;
            font-weight: bold;
            text-transform: uppercase;
            margin-left: auto;
        }

        .priority-very-high {
            background: #fee2e2;
            color: var(--priority-high);
        }

        .priority-high {
            background: #ffedd5;
            color: var(--priority-med);
        }

        .priority-medium {
            background: #f3f4f6;
            color: var(--priority-low);
        }

        /* Question text */
        .question-text {
            font-size: 1.2rem;
            margin-bottom: 2rem;
        }

        .question-text blockquote {
            border-left: none;
            padding-left: 0;
            margin: 0;
            color: var(--text-color);
            font-style: normal;
            line-height: 1.8;
        }

        .exam-version-chip {
            display: inline-block;
            font-size: 0.7rem;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: #f3f4f6;
            color: #6b7280;
            padding: 0.15rem 0.5rem;
            border-radius: 9999px;
            font-weight: 600;
            letter-spacing: 0.02em;
            vertical-align: middle;
            margin-bottom: 0.75rem;
        }

        .question-text .version-block + .version-block {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid #e5e7eb;
        }

        .question-context {
            background: #f8f9fa;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 1rem 1.25rem;
            margin-bottom: 1.25rem;
            font-size: 1.05rem;
            line-height: 1.9;
            color: #374151;
        }

        .question-context .doc-line {
            display: block;
            padding-left: 0.25rem;
        }

        .question-context .context-label {
            display: block;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 0.35rem;
        }

        .question-parts {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .question-parts li {
            padding: 0.5rem 0;
        }

        .question-parts li + li {
            border-top: 1px solid #f0f0f0;
        }

        .question-parts .part-label {
            font-weight: 600;
            color: var(--accent-color);
            margin-right: 0.4rem;
        }

        /* Data/Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            font-size: 0.95rem;
        }

        .data-table th,
        .data-table td {
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            text-align: left;
        }

        .data-table th {
            background: var(--bg-color);
            font-weight: 600;
        }

        /* Show solution button */
        .solution-toggle {
            display: block;
            width: 100%;
            padding: 1rem 2rem;
            margin: 2rem 0;
            font-size: 1.1rem;
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-family: inherit;
            transition: background 0.2s;
        }

        .solution-toggle:hover {
            background: #1d4ed8;
        }

        /* Solution section */
        .solution {
            display: none;
            background: var(--solution-bg);
            border: 1px solid #bae6fd;
            border-radius: 6px;
            padding: 2rem;
            margin-top: 1.5rem;
        }

        .solution.visible {
            display: block;
        }

        .solution h3 {
            color: var(--accent-color);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .solution h4 {
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            font-size: 1rem;
            color: #4b5563;
        }

        .solution pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 4px;
            overflow-x: auto;
            font-family: "Courier New", monospace;
            font-size: 0.9rem;
            margin: 1rem 0;
        }

        .solution code {
            font-family: "Courier New", monospace;
            background: #f1f5f9;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.9em;
        }

        .solution .formula {
            background: white;
            padding: 1rem;
            border-radius: 4px;
            border: 1px solid #e5e7eb;
            font-family: "Courier New", monospace;
            text-align: center;
            margin: 1rem 0;
        }

        /* Navigation footer */
        .nav-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 0;
            margin-top: 2rem;
            border-top: 2px solid var(--bg-color);
        }

        .nav-btn {
            padding: 0.75rem 1.5rem;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-size: 1rem;
        }

        .nav-btn:hover {
            background: var(--bg-color);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .question-counter {
            font-size: 0.95rem;
            color: #666;
        }

        /* Keyboard hint */
        .keyboard-hint {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-family: sans-serif;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .keyboard-hint.visible {
            opacity: 1;
        }

        /* Print styles */
        @media print {
            nav, .solution-toggle, .nav-footer, .keyboard-hint {
                display: none;
            }
            .question-container {
                display: block !important;
                page-break-after: always;
            }
        }
    </style>
</head>
<body>
    <nav id="topicNav">
        <button onclick="showBlock('block1')" class="nav-btn-topic" data-block="block1">1. Indexing</button>
        <button onclick="showBlock('block2')" class="nav-btn-topic" data-block="block2">2. Vectors</button>
        <button onclick="showBlock('block3')" class="nav-btn-topic" data-block="block3">3. Evaluation</button>
        <button onclick="showBlock('block4')" class="nav-btn-topic" data-block="block4">4. Classification</button>
        <button onclick="showBlock('block5')" class="nav-btn-topic" data-block="block5">5. Clustering</button>
        <button onclick="showBlock('block6')" class="nav-btn-topic" data-block="block6">6. Rare Topics</button>
        <a href="index.html" class="nav-home" title="All study tools">&#8962;</a>
    </nav>

    <div class="progress">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <div class="keyboard-hint" id="keyboardHint">
        ↑↓ Navigate • Space: Toggle Answer
    </div>

    <!-- BLOCK 1: Indexing & Retrieval -->
    <div class="question-container active" data-block="block1" data-index="0">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">1</span>
                <span class="question-meta">Compression — VBC, Gamma, Gap Encoding</span>
                <span class="priority priority-very-high">★★★★ Very High (4/4)</span>
            </div>
            
            <div class="question-text">
                <span class="exam-version-chip">WS24/25</span>
                <div class="question-context">
                    <span class="context-label">Given:</span>
                    <span class="doc-line">d₁: phone expensive buy</span>
                    <span class="doc-line">d₄: computer buy</span>
                    <span class="doc-line">d₉: expensive buy</span>
                </div>
                <ol class="question-parts">
                    <li><span class="part-label">a)</span> Provide the GAP encoding for the postings list of "expensive". Compress using Variable Byte Code.</li>
                    <li><span class="part-label">b)</span> Is this compression lossy or lossless? Explain the difference.</li>
                </ol>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>
                
                <h4>Step 1 — Build Inverted Index</h4>
                <ul>
                    <li>buy → [1, 4, 9]</li>
                    <li>expensive → [1, 9]</li>
                    <li>phone → [1]</li>
                    <li>computer → [4]</li>
                </ul>

                <h4>Step 2 — Gap Encode "expensive"</h4>
                <p>Postings [1, 9] → gaps <strong>[1, 8]</strong> (9−1=8)</p>

                <h4>Step 3 — VBC Encode</h4>
                <div class="formula">
                    1 → binary 0000001 → 10000001<br>
                    8 → binary 0001000 → 10001000
                </div>

                <h4>Part 1.3 — Lossy vs Lossless</h4>
                <p><strong>VBC is lossless</strong> — you can decode it back to the exact original gap values and reconstruct the posting list perfectly.</p>
                
                <p><strong>Lossless:</strong> Original data can be perfectly reconstructed (VBC, Gamma, Gap encoding)</p>
                <p><strong>Lossy:</strong> Some information is permanently lost (case folding, stemming, stop word removal)</p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()" disabled>← Previous</button>
            <span class="question-counter">1 / 20</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block1" data-index="1">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">1B</span>
                <span class="question-meta">Compression — Gamma Code</span>
                <span class="priority priority-very-high">★★★★ Very High (4/4)</span>
            </div>

            <div class="question-text">
                <span class="exam-version-chip">WS19/20</span>
                <div class="question-context">
                    <span class="context-label">Given:</span>
                    <span class="doc-line">d₁: phone expensive buy</span>
                    <span class="doc-line">d₃: expensive buy</span>
                    <span class="doc-line">d₁₃: buy</span>
                </div>
                <blockquote>
                    Write the gap sequence for "expensive" in gamma code.
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>

                <h4>Step 1 — Postings for "expensive"</h4>
                <p>expensive → [1, 3]</p>

                <h4>Step 2 — Gap Encode</h4>
                <p>Postings [1, 3] → gaps <strong>[1, 2]</strong> (3−1=2)</p>

                <h4>Step 3 — Gamma Encode</h4>
                <div class="formula">
                    1 → binary "1" → length 1 → prefix: (none) → <strong>0</strong><br>
                    2 → binary "10" → length 2 → prefix: 1 one + zero = "10" → append "0" → <strong>100</strong>
                </div>

                <h4>How Gamma Works:</h4>
                <ol>
                    <li>Write number in binary (e.g., 6 = 110)</li>
                    <li>Count bits = length (e.g., 3)</li>
                    <li>Write (length − 1) ones then a zero as prefix</li>
                    <li>Append binary WITHOUT the leading 1</li>
                </ol>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">– / –</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block1" data-index="2">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">2</span>
                <span class="question-meta">Inverted Index Construction</span>
                <span class="priority priority-high">★★★ High (3/4)</span>
            </div>
            
            <div class="question-text">
                <span class="exam-version-chip">WS24/25</span>
                <div class="question-context">
                    <span class="context-label">Given:</span>
                    <span class="doc-line">d₁: phone expensive buy</span>
                    <span class="doc-line">d₄: computer buy</span>
                    <span class="doc-line">d₉: expensive buy</span>
                </div>
                <blockquote>
                    Create the Inverted Index. No normalization required.
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Term</th>
                            <th>df</th>
                            <th>Posting List</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>buy</td>
                            <td>3</td>
                            <td>1 → 4 → 9</td>
                        </tr>
                        <tr>
                            <td>expensive</td>
                            <td>2</td>
                            <td>1 → 9</td>
                        </tr>
                        <tr>
                            <td>phone</td>
                            <td>1</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>computer</td>
                            <td>1</td>
                            <td>4</td>
                        </tr>
                    </tbody>
                </table>
                <p><em>That's it. No Boolean queries, no term-doc matrix. ~1 minute.</em></p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">2 / 20</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block1" data-index="3">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">2B</span>
                <span class="question-meta">Inverted Index Construction</span>
                <span class="priority priority-high">★★★ High (3/4)</span>
            </div>

            <div class="question-text">
                <span class="exam-version-chip">WS19/20</span>
                <div class="question-context">
                    <span class="context-label">Given:</span>
                    <span class="doc-line">d₁: phone expensive buy</span>
                    <span class="doc-line">d₃: expensive buy</span>
                    <span class="doc-line">d₁₃: buy</span>
                </div>
                <blockquote>
                    Create a full inverted index.
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>
                <table class="data-table">
                    <thead>
                        <tr><th>Term</th><th>df</th><th>Posting List</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>buy</td><td>3</td><td>1 → 3 → 13</td></tr>
                        <tr><td>expensive</td><td>2</td><td>1 → 3</td></tr>
                        <tr><td>phone</td><td>1</td><td>1</td></tr>
                    </tbody>
                </table>
                <p><em>Same format, different doc IDs. On the exam this feeds directly into compression.</em></p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">– / –</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block1" data-index="4">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">3</span>
                <span class="question-meta">Edit Distance (Damerau-Levenshtein)</span>
                <span class="priority priority-high">★★★ High (3/4)</span>
            </div>
            
            <div class="question-text">
                <span class="exam-version-chip">WS24/25</span>
                <blockquote>
                    Calculate the Damerau-Levenshtein distance of "bca" and "cba". Show the matrix and explain each step.
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution — Distance = 1 (single transposition)</h3>
                
                <table class="data-table">
                    <thead>
                        <tr>
                            <th></th>
                            <th></th>
                            <th>c</th>
                            <th>b</th>
                            <th>a</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td></td>
                            <td>0</td>
                            <td>1</td>
                            <td>2</td>
                            <td>3</td>
                        </tr>
                        <tr>
                            <td>b</td>
                            <td>1</td>
                            <td>1</td>
                            <td>1</td>
                            <td>2</td>
                        </tr>
                        <tr>
                            <td>c</td>
                            <td>2</td>
                            <td>1</td>
                            <td><strong>1★</strong></td>
                            <td>2</td>
                        </tr>
                        <tr>
                            <td>a</td>
                            <td>3</td>
                            <td>2</td>
                            <td>2</td>
                            <td><strong>1</strong></td>
                        </tr>
                    </tbody>
                </table>

                <p><strong>★ Transposition fires at d[2][2]:</strong> source "bc" matches target "cb" (adjacent swap) → d[0][0]+1 = 1. Final cell inherits the 1 since s[3]=t[3]='a' (match).</p>

                <h4>Operations allowed in Damerau-Levenshtein:</h4>
                <ul>
                    <li>Insertion</li>
                    <li>Deletion</li>
                    <li>Substitution</li>
                    <li><strong>Transposition</strong> (swapping adjacent characters)</li>
                </ul>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">3 / 20</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block1" data-index="5">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">3B</span>
                <span class="question-meta">Edit Distance (Damerau-Levenshtein)</span>
                <span class="priority priority-high">★★★ High (3/4)</span>
            </div>

            <div class="question-text">
                <span class="exam-version-chip">WS19/20</span>
                <blockquote>
                    Calculate the Damerau-Levenshtein distance between "abc" and "acb". Fill in a matrix. Explain.
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution — Distance = 1 (single transposition)</h3>

                <table class="data-table">
                    <thead>
                        <tr><th></th><th></th><th>a</th><th>c</th><th>b</th></tr>
                    </thead>
                    <tbody>
                        <tr><td></td><td>0</td><td>1</td><td>2</td><td>3</td></tr>
                        <tr><td>a</td><td>1</td><td>0</td><td>1</td><td>2</td></tr>
                        <tr><td>b</td><td>2</td><td>1</td><td>1</td><td>1</td></tr>
                        <tr><td>c</td><td>3</td><td>2</td><td>1</td><td><strong>1★</strong></td></tr>
                    </tbody>
                </table>

                <p><strong>★ Transposition fires at d[3][3]:</strong> source "bc" matches target "cb" → d[1][1]+1 = 0+1 = 1.</p>

                <p><strong>Exam tip:</strong> Both exam versions are distance=1 with one transposition. The exam tests whether you can fill the matrix and narrate the transposition step.</p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">– / –</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block1" data-index="6">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">4</span>
                <span class="question-meta">Permuterm Index</span>
                <span class="priority priority-medium">★★ Medium (2/4)</span> <span class="priority priority-very-high">Not in coursework</span>
            </div>
            
            <div class="question-text">
                <span class="exam-version-chip">WS24/25</span>
                <div class="question-context">
                    <span class="context-label">Given:</span>
                    <span class="doc-line">d₁: to two</span>
                    <span class="doc-line">d₂: too is</span>
                </div>
                <ol class="question-parts">
                    <li><span class="part-label">a)</span> What does the permuterm index look like?</li>
                    <li><span class="part-label">b)</span> Given query t*o — what terms would it result in? Explain.</li>
                </ol>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>
                
                <h4>How Permuterm Works:</h4>
                <ol>
                    <li>Append $ to each term: "hello" → "hello$"</li>
                    <li>Generate ALL rotations: hello$, ello$h, llo$he, lo$hel, o$hell, $hello</li>
                    <li>Store each rotation pointing to the original term in a B-tree</li>
                    <li>To search wildcard: rotate query so * is at the END, then prefix lookup</li>
                </ol>

                <h4>Permuterm Rotations:</h4>
                <ul>
                    <li><strong>"to"</strong> → to$: to$, o$t, $to</li>
                    <li><strong>"two"</strong> → two$: two$, wo$t, o$tw, $two</li>
                    <li><strong>"too"</strong> → too$: too$, oo$t, o$to, $too</li>
                    <li><strong>"is"</strong> → is$: is$, s$i, $is</li>
                </ul>

                <h4>Query t*o:</h4>
                <p>Append $: t*o$ → Rotate so * is at end: o$t* → Search for prefix o$t</p>
                <p><strong>Matches:</strong> o$t (from "to"), o$tw (from "two"), o$to (from "too")</p>
                <p><strong>Result: to, two, too</strong></p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">4 / 20</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block1" data-index="7">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">4B</span>
                <span class="question-meta">Permuterm Index</span>
                <span class="priority priority-medium">★★ Medium (2/4)</span> <span class="priority priority-very-high">Not in coursework</span>
            </div>

            <div class="question-text">
                <span class="exam-version-chip">WS21/22</span>
                <div class="question-context">
                    <span class="context-label">Given:</span>
                    <span class="doc-line">d₁: he is</span>
                    <span class="doc-line">d₂: she is</span>
                </div>
                <ol class="question-parts">
                    <li><span class="part-label">a)</span> How do you represent the terms in the permuterm index?</li>
                    <li><span class="part-label">b)</span> How do you look up *he and which elements are retrieved?</li>
                </ol>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>

                <h4>Permuterm Rotations:</h4>
                <ul>
                    <li><strong>"he"</strong> → he$: he$, e$h, $he</li>
                    <li><strong>"is"</strong> → is$: is$, s$i, $is</li>
                    <li><strong>"she"</strong> → she$: she$, he$s, e$sh, $she</li>
                </ul>

                <h4>Query *he:</h4>
                <p>Append $: *he$ → Rotate so * is at end: he$* → Search for prefix he$</p>
                <p><strong>Matches:</strong> he$ (from "he"), he$s (from "she")</p>
                <p><strong>Result: he, she</strong></p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">– / –</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <!-- BLOCK 2: Vector Space & Similarity -->
    <div class="question-container" data-block="block2" data-index="8">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">1</span>
                <span class="question-meta">Vector Space Plotting</span>
                <span class="priority priority-very-high">★★★★ Very High (4/4)</span>
            </div>
            
            <div class="question-text">
                <span class="exam-version-chip">WS24/25</span>
                <div class="question-context">
                    <span class="context-label">Documents:</span>
                    <span class="doc-line">d₁: yes yes no</span>
                    <span class="doc-line">d₂: yes yes yes yes no</span>
                    <span class="doc-line">d₃: yes yes no no no no no</span>
                    <span class="doc-line" style="color:#6b7280; font-size:0.9rem; margin-top:0.25rem;">(Grid provided 0–5 on both axes)</span>
                </div>
                <blockquote>
                    Draw the documents into the vector space. No weighting or log-scaling required.
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>
                
                <h4>How to Solve:</h4>
                <ol>
                    <li>Count raw term frequencies for each term dimension</li>
                    <li>Plot as points: (tf_term1, tf_term2)</li>
                    <li>No weighting, no normalization, no log scaling</li>
                </ol>

                <h4>Coordinates:</h4>
                <ul>
                    <li><strong>d₁</strong> = (yes=2, no=1) → point <strong>(2, 1)</strong></li>
                    <li><strong>d₂</strong> = (yes=4, no=1) → point <strong>(4, 1)</strong></li>
                    <li><strong>d₃</strong> = (yes=2, no=5) → point <strong>(2, 5)</strong></li>
                </ul>

                <p><em>This question always leads into cosine similarity or HAC clustering in the next subtask.</em></p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">5 / 20</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block2" data-index="9">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">1B</span>
                <span class="question-meta">Vector Space Plotting</span>
                <span class="priority priority-very-high">★★★★ Very High (4/4)</span>
            </div>

            <div class="question-text">
                <span class="exam-version-chip">WS21/22</span>
                <div class="question-context">
                    <span class="context-label">Documents:</span>
                    <span class="doc-line">A: yes yes</span>
                    <span class="doc-line">B: no no no no</span>
                    <span class="doc-line">Q: no no no no yes yes</span>
                    <span class="doc-line" style="color:#6b7280; font-size:0.9rem; margin-top:0.25rem;">(Axes: x = "yes", y = "no")</span>
                </div>
                <blockquote>
                    Plot the documents and query into the vector space.
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>

                <h4>Coordinates:</h4>
                <ul>
                    <li><strong>A</strong> = (yes=2, no=0) → point <strong>(2, 0)</strong></li>
                    <li><strong>B</strong> = (yes=0, no=4) → point <strong>(0, 4)</strong></li>
                    <li><strong>Q</strong> = (yes=2, no=4) → point <strong>(2, 4)</strong></li>
                </ul>

                <p><em>A sits on the x-axis, B on the y-axis, Q is in the upper-right quadrant. This setup feeds directly into cosine similarity.</em></p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">– / –</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block2" data-index="10">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">2</span>
                <span class="question-meta">Cosine Similarity</span>
                <span class="priority priority-high">★★★ High (3/4)</span>
            </div>
            
            <div class="question-text">
                <span class="exam-version-chip">WS21/22</span>
                <blockquote>
                    Calculate cosine similarity between A=(2,0) and Q=(2,4), and between B=(0,4) and Q=(2,4). Which is more similar?
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>
                
                <h4>Formula:</h4>
                <div class="formula">
                    cos(q, d) = (q⃗ · d⃗) / (|q⃗| × |d⃗|)
                </div>

                <h4>Calculations:</h4>
                <p><strong>cos(A, Q)</strong> = (2×2 + 0×4) / (√4 × √20) = 4 / (2 × 4.47) = 4/8.94 = <strong>0.447</strong></p>
                
                <p><strong>cos(B, Q)</strong> = (0×2 + 4×4) / (√16 × √20) = 16 / (4 × 4.47) = 16/17.89 = <strong>0.894</strong></p>

                <h4>Answer:</h4>
                <p><strong>B is more similar</strong> (despite Q containing both "yes" and "no", Q's "no" count dominates)</p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">6 / 20</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block2" data-index="11">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">2B</span>
                <span class="question-meta">Cosine Similarity</span>
                <span class="priority priority-high">★★★ High (3/4)</span>
            </div>

            <div class="question-text">
                <span class="exam-version-chip">WS19/20</span>
                <div class="question-context">
                    <span class="context-label">Documents:</span>
                    <span class="doc-line">A: read read → (2, 0)</span>
                    <span class="doc-line">B: write → (0, 1)</span>
                    <span class="doc-line">Q: read read write → (2, 1)</span>
                </div>
                <blockquote>
                    Calculate cosine similarity between each document and Q. Which is more similar?
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>

                <h4>Formula:</h4>
                <div class="formula">
                    cos(q, d) = (q⃗ · d⃗) / (|q⃗| × |d⃗|)
                </div>

                <h4>Calculations:</h4>
                <p><strong>cos(A, Q)</strong> = (2×2 + 0×1) / (√4 × √5) = 4 / (2 × 2.236) = 4/4.472 = <strong>0.894</strong></p>

                <p><strong>cos(B, Q)</strong> = (0×2 + 1×1) / (√1 × √5) = 1 / 2.236 = <strong>0.447</strong></p>

                <h4>Answer:</h4>
                <p><strong>A is more similar to Q.</strong> ~1 minute with calculator. No TF-IDF, no log scaling — just raw counts.</p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">– / –</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <!-- BLOCK 3: Evaluation -->
    <div class="question-container" data-block="block3" data-index="12">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">1</span>
                <span class="question-meta">Precision-Recall Curves</span>
                <span class="priority priority-medium">★★ Medium (2/4)</span>
            </div>
            
            <div class="question-text">
                <span class="exam-version-chip">WS24/25</span>
                <div class="question-context">
                    <span class="context-label">Given:</span>
                    <span class="doc-line">Result = (1, 3, 5, 9, 2)</span>
                    <span class="doc-line">Correct = (1, 2, 4, 8, 9)</span>
                </div>
                <blockquote>
                    Draw the corresponding Precision-Recall graph (without interpolation). Give the P-R coordinates.
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>
                
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Doc</th>
                            <th>Relevant?</th>
                            <th>P@k</th>
                            <th>R@k</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>1</td>
                            <td>✓</td>
                            <td>1/1 = 1.000</td>
                            <td>1/5 = 0.200</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>3</td>
                            <td>✗</td>
                            <td>1/2 = 0.500</td>
                            <td>1/5 = 0.200</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>5</td>
                            <td>✗</td>
                            <td>1/3 = 0.333</td>
                            <td>1/5 = 0.200</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>9</td>
                            <td>✓</td>
                            <td>2/4 = 0.500</td>
                            <td>2/5 = 0.400</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>2</td>
                            <td>✓</td>
                            <td>3/5 = 0.600</td>
                            <td>3/5 = 0.600</td>
                        </tr>
                    </tbody>
                </table>

                <h4>P-R Coordinates:</h4>
                <p><strong>(0.2, 1.0), (0.2, 0.5), (0.2, 0.333), (0.4, 0.5), (0.6, 0.6)</strong></p>

                <p><em>Docs 4, 8 never retrieved → recall never reaches 1.0</em></p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">7 / 20</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block3" data-index="13">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">1B</span>
                <span class="question-meta">Precision-Recall Curves</span>
                <span class="priority priority-medium">★★ Medium (2/4)</span>
            </div>

            <div class="question-text">
                <span class="exam-version-chip">WS21/22</span>
                <div class="question-context">
                    <span class="context-label">Given:</span>
                    <span class="doc-line">Ranking = {1, 3, 4, 7, 9, 11, 8}</span>
                    <span class="doc-line">Gold = {1, 2, 3, 4, 8}</span>
                </div>
                <blockquote>
                    Draw the complete precision-recall curve.
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>

                <table class="data-table">
                    <thead>
                        <tr><th>Rank</th><th>Doc</th><th>Relevant?</th><th>P@k</th><th>R@k</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>1</td><td>1</td><td>✓</td><td>1/1 = 1.000</td><td>1/5 = 0.200</td></tr>
                        <tr><td>2</td><td>3</td><td>✓</td><td>2/2 = 1.000</td><td>2/5 = 0.400</td></tr>
                        <tr><td>3</td><td>4</td><td>✓</td><td>3/3 = 1.000</td><td>3/5 = 0.600</td></tr>
                        <tr><td>4</td><td>7</td><td>✗</td><td>3/4 = 0.750</td><td>3/5 = 0.600</td></tr>
                        <tr><td>5</td><td>9</td><td>✗</td><td>3/5 = 0.600</td><td>3/5 = 0.600</td></tr>
                        <tr><td>6</td><td>11</td><td>✗</td><td>3/6 = 0.500</td><td>3/5 = 0.600</td></tr>
                        <tr><td>7</td><td>8</td><td>✓</td><td>4/7 = 0.571</td><td>4/5 = 0.800</td></tr>
                    </tbody>
                </table>

                <h4>P-R Coordinates:</h4>
                <p><strong>(0.2, 1.0), (0.4, 1.0), (0.6, 1.0), (0.6, 0.75), (0.6, 0.6), (0.6, 0.5), (0.8, 0.571)</strong></p>

                <p><em>Doc 2 never retrieved → recall never reaches 1.0. Note the first 3 results are all relevant — precision stays at 1.0 early.</em></p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">– / –</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <!-- BLOCK 4: Classification -->
    <div class="question-container" data-block="block4" data-index="14">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">1</span>
                <span class="question-meta">Naive Bayes</span>
                <span class="priority priority-medium">★★ Medium (2/4)</span>
            </div>
            
            <div class="question-text">
                <span class="exam-version-chip">WS24/25 · Conceptual</span>
                <div class="question-context">
                    <span class="context-label">Given:</span>
                    <span class="doc-line">D documents, C classes, M terms, T tokens per document</span>
                </div>
                <ol class="question-parts">
                    <li><span class="part-label">a)</span> How many variables does training create?</li>
                    <li><span class="part-label">b)</span> Time complexity of classifying T_test with t tokens? (Big-O)</li>
                    <li><span class="part-label">c)</span> What is add-1 smoothing? What is it needed for? Provide the formula.</li>
                </ol>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>
                
                <h4>7.1 — Training Variables:</h4>
                <p><strong>C(M + 1)</strong> or equivalently C + CM</p>
                <ul>
                    <li>C priors</li>
                    <li>C × M conditional probabilities</li>
                </ul>

                <h4>7.2 — Test Time Complexity:</h4>
                <p><strong>O(C × t)</strong> — for each class, multiply t term probabilities</p>

                <h4>7.3 — Add-1 Smoothing:</h4>
                <div class="formula">
                    P̂(t|c) = (T_ct + 1) / (ΣT_ct' + B)<br>
                    where B = vocabulary size
                </div>
                <p><strong>Why needed:</strong> Add 1 to every term count to prevent zero probabilities. A single unseen word zeros out the entire class probability.</p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">8 / 20</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block4" data-index="15">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">2</span>
                <span class="question-meta">Naive Bayes — Full Calculation</span>
                <span class="priority priority-medium">★★ Medium (2/4)</span>
            </div>
            
            <div class="question-text">
                <span class="exam-version-chip">WS21/22</span>
                <div class="question-context">
                    <span class="context-label">Training data:</span>
                    <span class="doc-line">German → {Sausage Cheese, Sausage Wine}</span>
                    <span class="doc-line">French → {Cheese Baguette, Wine, Wine Wine}</span>
                </div>
                <blockquote>
                    Calculate ALL parameters of the Naive Bayes model with add-one smoothing.
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>
                
                <p><strong>Vocabulary:</strong> V = {Sausage, Cheese, Wine, Baguette} → B = |V| = 4</p>

                <h4>Priors:</h4>
                <ul>
                    <li>P(German) = 2/5 = <strong>0.4</strong></li>
                    <li>P(French) = 3/5 = <strong>0.6</strong></li>
                </ul>

                <h4>Token counts:</h4>
                <p><strong>German:</strong> Sausage(2) Cheese(1) Wine(1) Baguette(0) = 4 total</p>
                <p><strong>French:</strong> Sausage(0) Cheese(1) Wine(3) Baguette(1) = 5 total</p>

                <h4>Add-one smoothed conditionals:</h4>
                <p>denom_German = 4 + 4 = 8 | denom_French = 5 + 4 = 9</p>
                
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Term</th>
                            <th>count(Ger)</th>
                            <th>P(t|Ger)</th>
                            <th>count(Fr)</th>
                            <th>P(t|Fr)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Sausage</td>
                            <td>2</td>
                            <td><strong>3/8</strong></td>
                            <td>0</td>
                            <td><strong>1/9</strong></td>
                        </tr>
                        <tr>
                            <td>Cheese</td>
                            <td>1</td>
                            <td><strong>2/8</strong></td>
                            <td>1</td>
                            <td><strong>2/9</strong></td>
                        </tr>
                        <tr>
                            <td>Wine</td>
                            <td>1</td>
                            <td><strong>2/8</strong></td>
                            <td>3</td>
                            <td><strong>4/9</strong></td>
                        </tr>
                        <tr>
                            <td>Baguette</td>
                            <td>0</td>
                            <td><strong>1/8</strong></td>
                            <td>1</td>
                            <td><strong>2/9</strong></td>
                        </tr>
                    </tbody>
                </table>

                <p><em>This exam version STOPS here — no test document to classify.</em></p>
                <p><strong>Total parameters:</strong> 2 priors + 2×4 = 8 conditionals = <strong>10 parameters</strong></p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">9 / 20</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <!-- BLOCK 5: Clustering & Web Search -->
    <div class="question-container" data-block="block5" data-index="16">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">1</span>
                <span class="question-meta">HAC Dendrograms</span>
                <span class="priority priority-very-high">★★★★ Very High (4/4)</span> <span class="priority priority-very-high">Not in coursework</span>
            </div>
            
            <div class="question-text">
                <span class="exam-version-chip">WS24/25</span>
                <div class="question-context">
                    <span class="context-label">Given:</span>
                    <span class="doc-line">A(1,1), B(1,3), C(5,3)</span>
                </div>
                <blockquote>
                    Draw the dendrograms for both single-link and complete-link clustering. Explain your solution and the difference.
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>
                
                <h4>Distance Matrix:</h4>
                <ul>
                    <li>d(A,B) = √(0+4) = <strong>2</strong></li>
                    <li>d(B,C) = √(16+0) = <strong>4</strong></li>
                    <li>d(A,C) = √(16+4) = <strong>√20 ≈ 4.47</strong></li>
                </ul>

                <h4>Step 1 (both methods):</h4>
                <p>Merge A,B (smallest distance = 2)</p>

                <h4>Step 2 — Single-link:</h4>
                <p>d({A,B}, C) = min(d(A,C), d(B,C)) = min(4.47, 4) = <strong>4</strong></p>
                <p>Merge {A,B} with C at distance 4</p>

                <h4>Step 2 — Complete-link:</h4>
                <p>d({A,B}, C) = max(d(A,C), d(B,C)) = max(4.47, 4) = <strong>4.47</strong></p>
                <p>Merge {A,B} with C at distance 4.47</p>

                <h4>Dendrogram Structure:</h4>
                <pre>
Single-Link:           Complete-Link:
4.47|                  4.47|___________
  4 |___________         4 |
  3 |           |        3 |
  2 |___        |        2 |___        |
  1 |   |       |        1 |   |       |
    A   B       C          A   B       C
                </pre>

                <h4>Key Difference:</h4>
                <p><strong>Single-link</strong> can create "chaining" (long, spread-out clusters). <strong>Complete-link</strong> creates more compact, spherical clusters.</p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">10 / 20</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block5" data-index="17">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">1B</span>
                <span class="question-meta">HAC Dendrograms</span>
                <span class="priority priority-very-high">★★★★ Very High (4/4)</span> <span class="priority priority-very-high">Not in coursework</span>
            </div>

            <div class="question-text">
                <span class="exam-version-chip">WS24/25 · from vector plot</span>
                <div class="question-context">
                    <span class="context-label">Given (from vector space plotting):</span>
                    <span class="doc-line">d₁(2, 1), d₂(4, 1), d₃(2, 5)</span>
                </div>
                <blockquote>
                    Draw the dendrograms for both single-link and complete-link clustering. Explain the difference.
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>

                <h4>Distance Matrix:</h4>
                <ul>
                    <li>d(d₁,d₂) = √(4+0) = <strong>2</strong></li>
                    <li>d(d₁,d₃) = √(0+16) = <strong>4</strong></li>
                    <li>d(d₂,d₃) = √(4+16) = <strong>√20 ≈ 4.47</strong></li>
                </ul>

                <h4>Step 1 (both methods):</h4>
                <p>Merge d₁,d₂ (smallest distance = 2)</p>

                <h4>Step 2 — Single-link:</h4>
                <p>d({d₁,d₂}, d₃) = min(4, 4.47) = <strong>4</strong></p>

                <h4>Step 2 — Complete-link:</h4>
                <p>d({d₁,d₂}, d₃) = max(4, 4.47) = <strong>4.47</strong></p>

                <p><em>Same structure as Version A — practice with different point labels to build fluency.</em></p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">– / –</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block5" data-index="18">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">2</span>
                <span class="question-meta">PageRank</span>
                <span class="priority priority-high">★★★ High (3/4)</span>
            </div>
            
            <div class="question-text">
                <span class="exam-version-chip">WS24/25</span>
                <div class="question-context">
                    <span class="context-label">Given:</span>
                    <span class="doc-line">3-node graph (1↔2↔3, all with self-loops and cross-links)</span>
                    <span class="doc-line">Teleportation rate = 0.15</span>
                </div>
                <ol class="question-parts">
                    <li><span class="part-label">a)</span> What is the probability-transition matrix?</li>
                    <li><span class="part-label">b)</span> PageRank values? Hint: you may only need one step with uniform initial vector. Name the process.</li>
                </ol>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>
                
                <h4>The Steps:</h4>
                <ol>
                    <li>Draw/read the link graph → note outgoing links per node</li>
                    <li>Build transition matrix M (column-stochastic): M[i][j] = 1/outdegree(j) if j→i, else 0</li>
                    <li>Apply teleportation: P = (1-α)M + (α/n)·1 where α = teleportation rate</li>
                    <li>Power iteration: start with x⁰ = (1/n, ..., 1/n), compute x^(k+1) = P·x^k until convergence</li>
                </ol>

                <h4>Transition Matrix M:</h4>
                <pre>
M = | 0    0.5  0.5 |
    | 0.5  0.5  0   |
    | 0.5  0    0.5 |
                </pre>

                <h4>Google Matrix P (α = 0.15, n = 3):</h4>
                <p>P = 0.85M + (0.15/3)·1 = 0.85M + 0.05·1</p>
                <pre>
P = | 0.05   0.475  0.475 |
    | 0.475  0.475  0.05  |
    | 0.475  0.05   0.475 |
                </pre>

                <h4>Power Iteration from x⁰ = (1/3, 1/3, 1/3):</h4>
                <p>x¹ = P·x⁰ = <strong>(1/3, 1/3, 1/3)</strong> — already converged! (due to symmetric structure)</p>

                <h4>Stationary Distribution:</h4>
                <p><strong>π = (1/3, 1/3, 1/3)</strong></p>
                <p><em>The process is called the Power Method or Power Iteration.</em></p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">11 / 20</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block5" data-index="19">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">3</span>
                <span class="question-meta">PageRank — Reverse Design</span>
                <span class="priority priority-high">★★★ High (3/4)</span>
            </div>
            
            <div class="question-text">
                <span class="exam-version-chip">WS20/21</span>
                <div class="question-context">
                    <span class="context-label">Constraint:</span>
                    <span class="doc-line">PR(d₁) = PR(d₂), PR(d₁) > PR(d₃)</span>
                </div>
                <ol class="question-parts">
                    <li><span class="part-label">a)</span> Add links to d₁, d₂, d₃ that satisfy the constraints.</li>
                    <li><span class="part-label">b)</span> Create the transition matrix. Show it works via 2 iterations of the power method.</li>
                </ol>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>
                
                <h4>Design Strategy:</h4>
                <ol>
                    <li>Equal PR for d₁ and d₂ → make them <strong>symmetric</strong> (mutual links)</li>
                    <li>Higher than d₃ → d₃ <strong>gives its vote</strong> to d₁ and d₂, but <strong>receives no incoming links</strong></li>
                </ol>

                <h4>Links:</h4>
                <p>d₁→d₂, d₂→d₁, d₃→d₁, d₃→d₂</p>

                <h4>Transition Matrix M:</h4>
                <pre>
        d₁  d₂  d₃
  d₁  [ 0   1   0.5 ]
  d₂  [ 1   0   0.5 ]
  d₃  [ 0   0   0   ]
                </pre>

                <h4>Google Matrix P (α = 0.15, n = 3):</h4>
                <pre>
  P = [ 0.05   0.90   0.475 ]
      [ 0.90   0.05   0.475 ]
      [ 0.05   0.05   0.05  ]
                </pre>

                <h4>Power Iteration from x⁰ = (1/3, 1/3, 1/3):</h4>
                <p>x¹ = <strong>(0.475, 0.475, 0.05)</strong></p>
                <p>x² = <strong>(0.475, 0.475, 0.05)</strong> — converged after 1 step</p>

                <h4>Verification:</h4>
                <p>PR(d₁) = PR(d₂) = 0.475 > PR(d₃) = 0.05 ✓</p>
                
                <p><em>Key insight: symmetry between d₁↔d₂ guarantees equal PR. d₃ has no incoming links → it gets only teleportation (0.15/3 = 0.05).</em></p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">12 / 20</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <!-- BLOCK 6: Rare / Gap Topics -->
    <div class="question-container" data-block="block6" data-index="20">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">1</span>
                <span class="question-meta">Lossy vs Lossless Compression</span>
                <span class="priority priority-medium">★★ Medium (2/4)</span> <span class="priority priority-very-high">Not in coursework</span>
            </div>

            <div class="question-text">
                <span class="exam-version-chip">WS21/22</span>
                <ol class="question-parts">
                    <li><span class="part-label">a)</span> Explain the difference between lossy and lossless compression.</li>
                    <li><span class="part-label">b)</span> Provide two examples for lossy compression of the dictionary.</li>
                    <li><span class="part-label">c)</span> Can you think of a method for lossy compression of the postings lists?</li>
                </ol>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>

                <h4>a) Definitions:</h4>
                <p><strong>Lossless:</strong> Original data can be perfectly reconstructed — VBC, Gamma, Gap encoding, dictionary-as-a-string + blocking.</p>
                <p><strong>Lossy:</strong> Some information is permanently lost, but retrieval quality is acceptable.</p>

                <h4>b) Lossy Dictionary Examples:</h4>
                <ul>
                    <li><strong>Case folding:</strong> "THE" → "the" (loses case distinction)</li>
                    <li><strong>Stemming:</strong> "running" → "run" (loses morphological information)</li>
                    <li><strong>Stop word removal:</strong> "the", "a", "is" dropped entirely</li>
                </ul>

                <h4>c) Lossy Postings Compression:</h4>
                <p><strong>Static index pruning:</strong> Drop postings for low-tf documents — a term that appears once in a 10,000-word document is unlikely to be relevant.</p>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">– / –</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block6" data-index="21">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">2</span>
                <span class="question-meta">Classifier Decision Boundaries</span>
                <span class="priority priority-medium">★★ Medium (2/4)</span> <span class="priority priority-very-high">Not in coursework</span>
            </div>

            <div class="question-text">
                <span class="exam-version-chip">WS19/20</span>
                <blockquote>
                    Given data points from two classes, draw a separation that could have been created by: (a) Perceptron (b) SVM (c) kNN with k=1.
                </blockquote>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution — How to Identify Boundaries</h3>

                <table class="data-table">
                    <thead>
                        <tr><th>Classifier</th><th>Boundary Shape</th><th>Key Feature</th></tr>
                    </thead>
                    <tbody>
                        <tr><td><strong>SVM</strong></td><td>Straight line</td><td>Maximum margin between classes (widest gap)</td></tr>
                        <tr><td><strong>Perceptron</strong></td><td>Straight line</td><td>Any separating line (not necessarily max margin)</td></tr>
                        <tr><td><strong>Naive Bayes</strong></td><td>Straight line (axis-aligned)</td><td>Based on feature independence assumption</td></tr>
                        <tr><td><strong>kNN k=1</strong></td><td>Irregular, wrapping</td><td>Voronoi tessellation — follows nearest points</td></tr>
                        <tr><td><strong>kNN large k</strong></td><td>Smoother, less complex</td><td>More neighbors → smoother boundary</td></tr>
                    </tbody>
                </table>

                <h4>Rule of Thumb:</h4>
                <ul>
                    <li>Straight line with max margin → <strong>SVM</strong></li>
                    <li>Straight line (vertical/horizontal) → <strong>Naive Bayes</strong></li>
                    <li>Irregular/jagged boundary wrapping around points → <strong>kNN k=1</strong></li>
                    <li>Smooth but non-linear → <strong>kNN with larger k</strong></li>
                </ul>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">– / –</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <div class="question-container" data-block="block6" data-index="22">
        <div class="question-card">
            <div class="question-header">
                <span class="question-number">3</span>
                <span class="question-meta">XOR Problem &amp; Neural Networks</span>
                <span class="priority priority-medium">★★ Medium (2/4)</span> <span class="priority priority-very-high">Not in coursework</span>
            </div>

            <div class="question-text">
                <span class="exam-version-chip">WS20/21</span>
                <div class="question-context">
                    <span class="context-label">Documents:</span>
                    <span class="doc-line">A: He walks street</span>
                    <span class="doc-line">B: She walks beach</span>
                    <span class="doc-line">B: He walks beach</span>
                    <span class="doc-line">A: She walks street</span>
                    <span class="doc-line" style="color:#6b7280; font-size:0.9rem; margin-top:0.25rem;">Features: f₁ = "He" in doc, f₂ = "street" in doc</span>
                </div>
                <ol class="question-parts">
                    <li><span class="part-label">a)</span> Which classifiers can perfectly discriminate? (SVM / MaxEnt / NB / kNN)</li>
                    <li><span class="part-label">b)</span> Find different features so ALL classifiers work.</li>
                    <li><span class="part-label">c)</span> Draw a neural network with weights that classifies using f₁, f₂.</li>
                </ol>
            </div>

            <button class="solution-toggle" onclick="toggleSolution(this)">
                Show Solution
            </button>

            <div class="solution">
                <h3>Solution</h3>

                <h4>a) Why This Is XOR:</h4>
                <table class="data-table">
                    <thead>
                        <tr><th>Doc</th><th>f₁ (He)</th><th>f₂ (street)</th><th>Class</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>She walks street</td><td>0</td><td>1</td><td>A</td></tr>
                        <tr><td>She walks beach</td><td>0</td><td>0</td><td>B</td></tr>
                        <tr><td>He walks street</td><td>1</td><td>1</td><td>B</td></tr>
                        <tr><td>He walks beach</td><td>1</td><td>0</td><td>A</td></tr>
                    </tbody>
                </table>
                <p>Class A when features differ, Class B when features match — this is <strong>XOR</strong>. No linear classifier can solve XOR → NB, SVM, MaxEnt all fail.</p>
                <p><strong>Only kNN with k=1 works</strong> — each point is closest to itself.</p>

                <h4>b) Linearly Separable Features:</h4>
                <p>Need features where classes cluster together. E.g., a single combined feature like "He XOR street".</p>

                <h4>c) Neural Network (2→2→1):</h4>
                <ul>
                    <li>Hidden H₁: (f₁ AND NOT f₂) — weights w₁=1, w₂=−1, bias=−0.5</li>
                    <li>Hidden H₂: (NOT f₁ AND f₂) — weights w₁=−1, w₂=1, bias=−0.5</li>
                    <li>Output: H₁ OR H₂ — weights both=1, bias=−0.5</li>
                    <li>Step activation: fire if sum > 0</li>
                </ul>
            </div>
        </div>

        <div class="nav-footer">
            <button class="nav-btn" onclick="prevQuestion()">← Previous</button>
            <span class="question-counter">– / –</span>
            <button class="nav-btn" onclick="nextQuestion()">Next →</button>
        </div>
    </div>

    <script>
        let currentQuestion = 0;
        const totalQuestions = 23; // Update this as you add more questions

        function updateProgress() {
            const progress = ((currentQuestion + 1) / totalQuestions) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            
            // Update counter
            const counters = document.querySelectorAll('.question-counter');
            counters.forEach(counter => {
                counter.textContent = (currentQuestion + 1) + ' / ' + totalQuestions;
            });

            // Update nav buttons
            const containers = document.querySelectorAll('.question-container');
            containers.forEach((container, index) => {
                container.classList.toggle('active', index === currentQuestion);
            });

            // Update prev/next buttons
            const prevBtns = document.querySelectorAll('.nav-btn[onclick="prevQuestion()"]');
            const nextBtns = document.querySelectorAll('.nav-btn[onclick="nextQuestion()"]');

            prevBtns.forEach(btn => btn.disabled = currentQuestion === 0);
            nextBtns.forEach(btn => btn.disabled = currentQuestion === totalQuestions - 1);

            // Sync top nav with current block
            const activeBlock = containers[currentQuestion].dataset.block;
            document.querySelectorAll('.nav-btn-topic').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.block === activeBlock);
            });
        }

        function nextQuestion() {
            if (currentQuestion < totalQuestions - 1) {
                currentQuestion++;
                updateProgress();
            }
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                updateProgress();
            }
        }

        function toggleSolution(btn) {
            const solution = btn.nextElementSibling;
            solution.classList.toggle('visible');
            btn.textContent = solution.classList.contains('visible') ? 'Hide Solution' : 'Show Solution';
        }

        function showBlock(blockId) {
            const firstInBlock = document.querySelector(`.question-container[data-block="${blockId}"]`);
            if (firstInBlock) {
                const allContainers = document.querySelectorAll('.question-container');
                allContainers.forEach((container, index) => {
                    if (container === firstInBlock) {
                        currentQuestion = index;
                    }
                });
                updateProgress();
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowDown' || e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                if (e.key === ' ') {
                    // Space toggles solution on active question
                    const activeContainer = document.querySelector('.question-container.active');
                    const toggleBtn = activeContainer.querySelector('.solution-toggle');
                    if (toggleBtn) toggleSolution(toggleBtn);
                } else {
                    nextQuestion();
                }
            } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
                e.preventDefault();
                prevQuestion();
            }
        });

        // Show keyboard hint briefly
        setTimeout(() => {
            document.getElementById('keyboardHint').classList.add('visible');
        }, 1000);

        setTimeout(() => {
            document.getElementById('keyboardHint').classList.remove('visible');
        }, 5000);

        // Initialize
        updateProgress();
        showBlock('block1');
    </script>
</body>
</html>